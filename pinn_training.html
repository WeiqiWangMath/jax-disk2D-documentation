

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PINN Training &mdash; jax-disk2D 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/sync_videos.css?v=2293ad74" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=d45e8c67"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/sync_videos.js?v=71b0c0f2"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Default Parameters" href="default_parameters.html" />
    <link rel="prev" title="FARGO3D Integration" href="fargo_integration.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >

          
          
          <a href="index.html" class="icon icon-home">
            jax-disk2D
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="fargo_integration.html">FARGO3D Integration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">PINN Training</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#quick-summary">Quick Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="#visualization">Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#d-movies">2D Movies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#synchronized-video-comparison">Synchronized Video Comparison</a></li>
<li class="toctree-l3"><a class="reference internal" href="#loss-and-metrics">Loss and Metrics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#gpu-training">GPU Training</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="default_parameters.html">Default Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="project_structure.html">Project Structure</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">jax-disk2D</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">PINN Training</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/pinn_training.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pinn-training">
<h1>PINN Training<a class="headerlink" href="#pinn-training" title="Link to this heading"></a></h1>
<p>This section covers advanced training options for Physics-Informed Neural Networks (PINNs) with jax-disk2D. For the basic workflow of training a PINN model, see the <a class="reference internal" href="getting_started.html"><span class="doc">Getting Started</span></a> guide.</p>
<section id="quick-summary">
<h2>Quick Summary<a class="headerlink" href="#quick-summary" title="Link to this heading"></a></h2>
<p>Training a PINN involves:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>guild<span class="w"> </span>run<span class="w"> </span>pinn:train<span class="w"> </span>@parameters.yml<span class="w"> </span>fargo:to_xarray<span class="o">=</span>&lt;to_xarray_job_id&gt;
</pre></div>
</div>
<p>The training process loads converted FARGO3D data, initializes a neural network, and trains it to satisfy physics constraints (PDE residuals) without requiring training data. The network learns to solve the hydrodynamics equations directly from the physical laws encoded in the loss function.</p>
<p>For detailed information about all training parameters and their default values, see the <a class="reference internal" href="default_parameters.html"><span class="doc">Default Parameters</span></a> page.</p>
</section>
<section id="visualization">
<h2>Visualization<a class="headerlink" href="#visualization" title="Link to this heading"></a></h2>
<section id="d-movies">
<h3>2D Movies<a class="headerlink" href="#d-movies" title="Link to this heading"></a></h3>
<p>Generate 2D movies of the predictions:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>guild<span class="w"> </span>run<span class="w"> </span>pinn:draw_2d<span class="w"> </span>pinn:train<span class="o">=</span>&lt;train_job_id&gt;
</pre></div>
</div>
<p>This creates animated visualizations comparing the PINN predictions with the FARGO3D reference data.</p>
</section>
<section id="synchronized-video-comparison">
<h3>Synchronized Video Comparison<a class="headerlink" href="#synchronized-video-comparison" title="Link to this heading"></a></h3>
<p>The following example shows three synchronized videos playing together for comparison:</p>
<div class="video-group video-group-3">
    <div class="video-item">
        <video controls>
            <source src="movies/0bb155ba/dens-predict.mp4" type="video/mp4">
            Your browser does not support the video tag.
        </video>
    </div>
    <div class="video-item">
        <video controls>
            <source src="movies/1f1dc333/dens-predict.mp4" type="video/mp4">
            Your browser does not support the video tag.
        </video>
    </div>
    <div class="video-item">
        <video controls>
            <source src="movies/3c51e831/dens-predict.mp4" type="video/mp4">
            Your browser does not support the video tag.
        </video>
    </div>
</div><p>All three videos will play, pause, and seek together when you interact with any video in the group.</p>
</section>
<section id="loss-and-metrics">
<h3>Loss and Metrics<a class="headerlink" href="#loss-and-metrics" title="Link to this heading"></a></h3>
<p>Plot training loss and other metrics:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>guild<span class="w"> </span>run<span class="w"> </span>pinn:plot_tb_summary<span class="w"> </span>pinn:train<span class="o">=</span>&lt;train_job_id&gt;
</pre></div>
</div>
<p>Check the figures in <code class="docutils literal notranslate"><span class="pre">$GUILD_HOME/runs/&lt;train_job_id&gt;/runs/...</span></code></p>
</section>
</section>
<section id="gpu-training">
<h2>GPU Training<a class="headerlink" href="#gpu-training" title="Link to this heading"></a></h2>
<p>For GPU training on HPC systems, first start the training job:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>guild<span class="w"> </span>run<span class="w"> </span>pinn:train<span class="w"> </span>@parameters.yml<span class="w"> </span>fargo:to_xarray<span class="o">=</span>&lt;to_xarray_job_id&gt;
</pre></div>
</div>
<p>Then submit it to a GPU node using SLURM:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sbatch<span class="w"> </span>--time<span class="o">=</span><span class="m">40</span>:00<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>--mail-user<span class="o">=</span>JAX_DISK2D_MAIL_USER<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>--mail-type<span class="o">=</span>ALL<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>--account<span class="o">=</span>&lt;account&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>--gres<span class="o">=</span>gpu:1<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>--mem<span class="o">=</span>64G<span class="w"> </span><span class="se">\</span>
<span class="w">       </span>run_gpu.sh<span class="w"> </span>&lt;run_job_id&gt;
</pre></div>
</div>
<p>Replace <code class="docutils literal notranslate"><span class="pre">&lt;run_job_id&gt;</span></code> with the Guild run ID from the previous command.</p>
<p>See <a class="reference internal" href="api_reference.html"><span class="doc">API Reference</span></a> for detailed API documentation.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="fargo_integration.html" class="btn btn-neutral float-left" title="FARGO3D Integration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="default_parameters.html" class="btn btn-neutral float-right" title="Default Parameters" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Shunyuan Mao, Weiqi Wang.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>